# ä¸‹æ³¨å†å² (Betting History) æ ¼å¼è¯¦è§£

## ğŸ“‹ ä¸‹æ³¨å†å²æ ¼å¼è¯´æ˜

ä¸‹æ³¨å†å²ä½¿ç”¨ **ACPC (Annual Computer Poker Competition) åè®®**æ ¼å¼ã€‚

## ğŸ”¤ åŠ¨ä½œç¼–ç 

### åŸºæœ¬åŠ¨ä½œ

| å­—ç¬¦ | å«ä¹‰ | è¯´æ˜ |
|------|------|------|
| `c` | Call/Check | è·Ÿæ³¨æˆ–è¿‡ç‰Œ |
| `f` | Fold | å¼ƒç‰Œ |
| `r` | Raise | åŠ æ³¨ï¼ˆåé¢è·Ÿé‡‘é¢ï¼‰ |
| `a` | All-in | å…¨æŠ¼ï¼ˆåœ¨æŸäº›å®ç°ä¸­ï¼‰ |
| `/` | åˆ†éš”ç¬¦ | åˆ†éš”ä¸åŒè½®æ¬¡ï¼ˆPreflop/Flop/Turn/Riverï¼‰ |

### åŠ æ³¨æ ¼å¼

**`r{é‡‘é¢}`** è¡¨ç¤ºåŠ æ³¨åˆ°æŸä¸ªæ€»é‡‘é¢ï¼ˆä¸æ˜¯å¢é‡ï¼‰

ä¾‹å¦‚ï¼š
- `r2000` = åŠ æ³¨åˆ°æ€»æŠ•å…¥ 2000
- `r500` = åŠ æ³¨åˆ°æ€»æŠ•å…¥ 500

## ğŸ“ ç¤ºä¾‹è§£æ

### ç¤ºä¾‹1: `r2000f`

```
r2000  â†’ ç©å®¶åŠ æ³¨åˆ°æ€»æŠ•å…¥ 2000
f      â†’ ä¸‹ä¸€ä¸ªç©å®¶å¼ƒç‰Œ
```

**å®Œæ•´æµç¨‹**ï¼š
1. ç©å®¶2: All-inï¼ˆåŠ¨ä½œç¼–å·3ï¼‰ï¼Œæ€»æŠ•å…¥ 2000
2. ç©å®¶3: Foldï¼ˆåŠ¨ä½œç¼–å·0ï¼‰

**æ³¨æ„**ï¼š`r2000` ä¸­çš„ 2000 æ˜¯**æ€»æŠ•å…¥é‡‘é¢**ï¼Œä¸æ˜¯åŠ æ³¨çš„å¢é‡ã€‚

### ç¤ºä¾‹2: `r2000c`

```
r2000  â†’ ç©å®¶åŠ æ³¨åˆ°æ€»æŠ•å…¥ 2000
c      â†’ ä¸‹ä¸€ä¸ªç©å®¶è·Ÿæ³¨
```

### ç¤ºä¾‹3: `cccr700ccccc/`

```
ccc          â†’ å‰3ä¸ªç©å®¶éƒ½è·Ÿæ³¨/è¿‡ç‰Œ
r700         â†’ ç¬¬4ä¸ªç©å®¶åŠ æ³¨åˆ° 700
ccccc        â†’ åç»­5ä¸ªç©å®¶éƒ½è·Ÿæ³¨
/            â†’ åˆ†éš”ç¬¦ï¼ˆè¿›å…¥ä¸‹ä¸€è½®ï¼‰
```

### ç¤ºä¾‹4: `r2000cff`

```
r2000  â†’ ç©å®¶åŠ æ³¨åˆ° 2000
c      â†’ ç©å®¶è·Ÿæ³¨
f      â†’ ç©å®¶å¼ƒç‰Œ
f      â†’ ç©å®¶å¼ƒç‰Œ
```

## ğŸ” ä»£ç å®ç°

### ACPC åè®®ç¼–ç 

```cpp
// open_spiel/games/universal_poker/acpc_cpp/acpc_game.cc
std::string ACPCState::ActionToString(const Action &action) const {
  switch (action.type) {
    case ACPC_CALL:
      return "c";
    case ACPC_FOLD:
      return "f";
    case ACPC_RAISE:
      if (game_->IsLimitGame()) 
        return "r";  // é™æ³¨æ¸¸æˆï¼Œåªè¿”å› "r"
      return absl::StrCat("r", action.size);  // æ— é™æ³¨ï¼Œè¿”å› "r{é‡‘é¢}"
    default:
      SpielFatalError("Should never happen.");
  }
}
```

### ä¸‹æ³¨å†å²ç”Ÿæˆ

```cpp
// open_spiel/games/universal_poker/universal_poker.cc
std::string betting_history;
for (int r = 0; r <= acpc_state_.GetRound(); ++r) {
  if (r > 0) absl::StrAppend(&betting_history, "/");
  absl::StrAppend(&betting_history, acpc_state_.BettingSequence(r));
}
```

**æ ¼å¼**ï¼š`{Round0åŠ¨ä½œåºåˆ—}/{Round1åŠ¨ä½œåºåˆ—}/{Round2åŠ¨ä½œåºåˆ—}/...`

## âš ï¸ é‡è¦è¯´æ˜

### 1. `r{é‡‘é¢}` æ˜¯æ€»æŠ•å…¥ï¼Œä¸æ˜¯å¢é‡

**ç¤ºä¾‹**ï¼š
- åˆå§‹ç›²æ³¨ï¼šæ¯ä¸ªç©å®¶æŠ•å…¥ 100
- ç©å®¶åŠ æ³¨åˆ° 2000
- ä¸‹æ³¨å†å²ï¼š`r2000`ï¼ˆä¸æ˜¯ `r1900`ï¼‰

**è®¡ç®—å¢é‡**ï¼š
```
å¢é‡ = 2000 - å½“å‰æŠ•å…¥ = 2000 - 100 = 1900
```

### 2. åŠ¨ä½œé¡ºåº

ä¸‹æ³¨å†å²æŒ‰ç…§**åŠ¨ä½œå‘ç”Ÿçš„é¡ºåº**è®°å½•ï¼Œä»å·¦åˆ°å³ã€‚

### 3. è½®æ¬¡åˆ†éš”

`/` åˆ†éš”ä¸åŒè½®æ¬¡ï¼š
- Preflop çš„åŠ¨ä½œ
- `/` 
- Flop çš„åŠ¨ä½œ
- `/`
- Turn çš„åŠ¨ä½œ
- `/`
- River çš„åŠ¨ä½œ

### 4. ä¿¡æ¯çŠ¶æ€ä¸­çš„ç¼–ç 

**æ³¨æ„**ï¼šä¸‹æ³¨å†å²å­—ç¬¦ä¸²ï¼ˆ`betting_history`ï¼‰å’Œä¿¡æ¯çŠ¶æ€å‘é‡ä¸­çš„ç¼–ç **ä¸åŒ**ï¼š

| æ ¼å¼ | ä¸‹æ³¨å†å²å­—ç¬¦ä¸² | ä¿¡æ¯çŠ¶æ€å‘é‡ |
|------|--------------|-------------|
| Fold | `f` | `00` (2 bits) |
| Call | `c` | `10` (2 bits) |
| Raise | `r{é‡‘é¢}` | `01` (2 bits) |
| All-in | `a` æˆ– `r{é‡‘é¢}` | `11` (2 bits) |

ä¿¡æ¯çŠ¶æ€å‘é‡ä¸­ï¼š
- åŠ¨ä½œç±»å‹ç”¨ 2 bits ç¼–ç 
- ä¸‹æ³¨é‡‘é¢å•ç‹¬å­˜å‚¨åœ¨ `action_sizings` æ•°ç»„ä¸­

## ğŸ“Š å®Œæ•´ç¤ºä¾‹

### 6äººåœº Preflop ç¤ºä¾‹

```
åˆå§‹çŠ¶æ€ï¼š
- æ¯ä¸ªç©å®¶æŠ•å…¥ç›²æ³¨ 100
- åº•æ± : 600

åŠ¨ä½œåºåˆ—ï¼š
1. ç©å®¶2: Call (æŠ•å…¥100ï¼Œæ€»æŠ•å…¥100)
2. ç©å®¶3: Call (æŠ•å…¥100ï¼Œæ€»æŠ•å…¥100)
3. ç©å®¶4: Call (æŠ•å…¥100ï¼Œæ€»æŠ•å…¥100)
4. ç©å®¶5: Call (æŠ•å…¥100ï¼Œæ€»æŠ•å…¥100)
5. ç©å®¶0: Call (æŠ•å…¥100ï¼Œæ€»æŠ•å…¥100)
6. ç©å®¶1: Call (æŠ•å…¥100ï¼Œæ€»æŠ•å…¥100)

ä¸‹æ³¨å†å²: "cccccc"
```

### åŠ æ³¨ç¤ºä¾‹

```
åˆå§‹çŠ¶æ€ï¼š
- æ¯ä¸ªç©å®¶æŠ•å…¥ç›²æ³¨ 100
- åº•æ± : 600

åŠ¨ä½œåºåˆ—ï¼š
1. ç©å®¶2: All-in (æŠ•å…¥2000ï¼Œæ€»æŠ•å…¥2000)
2. ç©å®¶3: Call (æŠ•å…¥2000ï¼Œæ€»æŠ•å…¥2000)
3. ç©å®¶4: Fold
4. ç©å®¶5: Fold
5. ç©å®¶0: Fold
6. ç©å®¶1: Fold

ä¸‹æ³¨å†å²: "r2000cffff"
```

**è§£æ**ï¼š
- `r2000`: ç©å®¶2 å…¨æŠ¼åˆ° 2000ï¼ˆæ€»æŠ•å…¥ï¼‰
- `c`: ç©å®¶3 è·Ÿæ³¨ï¼ˆä¹ŸæŠ•å…¥ 2000ï¼‰
- `ffff`: ç©å®¶4ã€5ã€0ã€1 éƒ½å¼ƒç‰Œ

## ğŸ”— ç›¸å…³ä»£ç ä½ç½®

- **ACPC åŠ¨ä½œç¼–ç **: `open_spiel/games/universal_poker/acpc_cpp/acpc_game.cc:250-263`
- **ä¸‹æ³¨å†å²ç”Ÿæˆ**: `open_spiel/games/universal_poker/universal_poker.cc:1062-1067`
- **ä¿¡æ¯çŠ¶æ€ç¼–ç **: `open_spiel/games/universal_poker/universal_poker.cc:455-481`

## ğŸ“š ACPC åè®®å‚è€ƒ

ACPC (Annual Computer Poker Competition) åè®®æ˜¯æ ‡å‡†çš„è®¡ç®—æœºæ‰‘å…‹é€šä¿¡åè®®ã€‚

æ›´å¤šä¿¡æ¯ï¼š
- ACPC åè®®æ–‡æ¡£
- OpenSpiel Universal Poker å®ç°

